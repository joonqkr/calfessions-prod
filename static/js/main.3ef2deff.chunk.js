(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{119:function(e,t,s){},120:function(e,t,s){},131:function(e,t){},133:function(e,t,s){},137:function(e,t,s){},138:function(e,t,s){},139:function(e,t,s){},140:function(e,t,s){},141:function(e,t,s){},142:function(e,t,s){},143:function(e,t,s){},144:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),n=s(31),r=s.n(n),i=s(8),o=(s(68),s(33)),l=s(16),u=s(29),j=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:t.payload};case"FOLLOW":return Object(u.a)(Object(u.a)({},e),{},{user:Object(u.a)(Object(u.a)({},e.user),{},{following:[].concat(Object(l.a)(e.user.following),[t.payload])})});case"UNFOLLOW":return Object(u.a)(Object(u.a)({},e),{},{user:Object(u.a)(Object(u.a)({},e.user),{},{following:e.user.following.filter((function(e){return e!==t.payload}))})});case"UPDATE_PROFILE":return Object(u.a)(Object(u.a)({},e),{},{user:Object(u.a)(Object(u.a)({},e.user),{},{profilePicture:t.payload})});default:return e}},d=s(2),b={user:JSON.parse(localStorage.getItem("user"))||null,isFetching:!1,error:!1},h=Object(a.createContext)(b),p=function(e){var t=e.children,s=Object(a.useReducer)(j,b),c=Object(i.a)(s,2),n=c[0],r=c[1];return Object(a.useEffect)((function(){localStorage.setItem("user",JSON.stringify(n.user))}),[n.user]),Object(d.jsx)(h.Provider,{value:{user:n.user,isFetching:n.isFetching,error:n.error,dispatch:r},children:t})},m=s(54),O=s(37),f=s(79),x=s(82),g=function(e){Object(f.a)(s,e);var t=Object(x.a)(s);function s(){var e;Object(m.a)(this,s);for(var a=arguments.length,c=new Array(a),n=0;n<a;n++)c[n]=arguments[n];return(e=t.call.apply(t,[this].concat(c))).logout=function(){localStorage.clear(),window.location.href="/register"},e}return Object(O.a)(s,[{key:"render",value:function(){return Object(d.jsx)("button",{onClick:this.logout,children:"Log out"})}}]),s}(a.Component),v=s(191),N=s(192),k=s(25),C=s(17),y=s.n(C),w=(s(99),s(19)),S=s.n(w),I=s(81),L=s(20),R=s(21),F=s(47),B=s(46),A=s(34),E=s(45),_=s(44);function D(e){var t=e.post,s=Object(a.useState)(t.likes.length),c=Object(i.a)(s,2),n=c[0],r=c[1],o=Object(a.useState)(!1),l=Object(i.a)(o,2),u=l[0],j=l[1],b=Object(a.useState)({}),p=Object(i.a)(b,2),m=(p[0],p[1]),O=Object(a.useContext)(h).user;Object(a.useEffect)((function(){j(t.likes.includes(O._id))}),[t.likes,O._id]),Object(a.useEffect)((function(){var e=function(){var e=Object(k.a)(y.a.mark((function e(){var s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.get("/users?userId=".concat(t.userId));case 2:s=e.sent,m(s.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t.userId]);var f=function(){try{S.a.put("/posts/".concat(t._id,"/like"),{userId:O._id})}catch(e){console.log(e)}r(u?n-1:n+1),j(!u)},x=new Map([["classes",L.b],["roommates",R.a],["clubs",L.a],["housing",R.b],["relationships",L.c],["food",_.a],["travel",L.d],["fun",A.a],["advice",E.a],["life",R.c],["thirst",B.a],["rant",A.b],["wholesome",R.d],["sad",F.a],["miscellaneous",R.e]]);return Object(d.jsx)("div",{className:"post",children:Object(d.jsxs)("div",{className:"postWrapper",children:[Object(d.jsxs)("div",{className:"postTop",children:[Object(d.jsx)("div",{className:"postTopLeft",children:Object(d.jsx)("div",{className:"listContainer",children:t.tags.map((function(e,t){return function(e){var t=x.get(e);return Object(d.jsxs)("span",{className:"selected tagElement",children:[Object(d.jsx)(t,{}),Object(d.jsx)("input",{type:"button",className:"buttonInside",value:e})]})}(e)}))})}),Object(d.jsx)("div",{className:"postTopRight",children:Object(d.jsx)("span",{className:"postDate",children:Object(I.a)(t.createdAt)})})]}),Object(d.jsx)("div",{className:"postCenter",children:Object(d.jsx)("span",{className:"postText",children:t.description})}),Object(d.jsx)("div",{className:"postBottom",children:Object(d.jsxs)("div",{className:"postBottomLeft",children:[u?Object(d.jsx)(L.c,{className:"likeIcon",onClick:f}):Object(d.jsx)(L.e,{className:"likeIcon",onClick:f}),Object(d.jsx)("span",{className:"".concat(u?"liked":""," postLikeCounter"),children:n})]})})]})})}s(119);function P(){var e=Object(a.useContext)(h).user,t=Object(a.useRef)(),s=Object(a.useState)([{name:"classes",isChecked:!1},{name:"roommates",isChecked:!1},{name:"clubs",isChecked:!1},{name:"housing",isChecked:!1},{name:"relationships",isChecked:!1},{name:"food",isChecked:!1},{name:"travel",isChecked:!1},{name:"fun",isChecked:!1},{name:"advice",isChecked:!1},{name:"life",isChecked:!1},{name:"thirst",isChecked:!1},{name:"rant",isChecked:!1},{name:"wholesome",isChecked:!1},{name:"sad",isChecked:!1},{name:"miscellaneous",isChecked:!1}]),c=Object(i.a)(s,2),n=c[0],r=c[1],o=new Map([["classes",L.b],["roommates",R.a],["clubs",L.a],["housing",R.b],["relationships",L.c],["food",_.a],["travel",L.d],["fun",A.a],["advice",E.a],["life",R.c],["thirst",B.a],["rant",A.b],["wholesome",R.d],["sad",F.a],["miscellaneous",R.e]]),u=function(){var s=Object(k.a)(y.a.mark((function s(a){var c,r;return y.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a.preventDefault(),c=[],n.forEach((function(e){e.isChecked&&c.push(e.name)})),r={userId:e._id,description:t.current.value,tags:c},s.prev=4,s.next=7,S.a.post("/posts",r);case 7:window.location.reload(),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(4),console.log(s.t0);case 13:case"end":return s.stop()}}),s,null,[[4,10]])})));return function(e){return s.apply(this,arguments)}}(),j=function(e,t){var s=o.get(e.name);return Object(d.jsxs)("span",{className:"".concat(e.isChecked?"selected":""," tagButton"),children:[Object(d.jsx)(s,{}),Object(d.jsx)("input",{type:"button",className:"buttonInside",value:e.name,onClick:function(){return function(e,t){var s=Object(l.a)(n);s[e].isChecked=t,r(s)}(t,!e.isChecked)}})]})};return Object(d.jsx)("div",{className:"share",children:Object(d.jsxs)("div",{className:"shareWrapper",children:[Object(d.jsx)("div",{className:"shareTop",children:Object(d.jsx)("textarea",{placeholder:"Share an anonymous confession...",className:"shareInput",ref:t})}),Object(d.jsxs)("form",{className:"shareBottom",onSubmit:u,children:[Object(d.jsx)("div",{className:"tagLabel",children:"ADD TAGS:"}),Object(d.jsx)("div",{className:"listContainer",children:n.map((function(e,t){return j(e,t)}))}),Object(d.jsx)("div",{className:"buttonContainer",children:Object(d.jsx)("button",{className:"shareButton",type:"submit",children:"Post"})})]})]})})}s(120);var T=s(121);function W(e){var t=Object(a.useState)([]),s=Object(i.a)(t,2),c=s[0],n=s[1],r=Object(a.useContext)(h).user;return Object(a.useEffect)((function(){var t=function(){var t=Object(k.a)(y.a.mark((function t(){var s;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.username){t.next=12;break}if(!e.likes){t.next=7;break}return t.next=4,S.a.get("/posts/likes/".concat(e.username));case 4:s=t.sent,t.next=10;break;case 7:return t.next=9,S.a.get("/posts/profile/".concat(e.username));case 9:s=t.sent;case 10:t.next=21;break;case 12:if(!(e.tags.length>0)){t.next=18;break}return t.next=15,S.a.get("/posts/timeline/tags",{params:{tags:e.tags},paramsSerializer:function(e){return T.stringify(e,{arrayFormat:"repeat"})}});case 15:s=t.sent,t.next=21;break;case 18:return t.next=20,S.a.get("/posts/timeline");case 20:s=t.sent;case 21:n(s.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 22:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e.username,r._id,e.tags,e.likes]),Object(d.jsx)("div",{className:"feed",children:Object(d.jsxs)("div",{className:"feedWrapper",children:[(e.username===r.username||!e.username)&&Object(d.jsx)(P,{}),c.map((function(e){return Object(d.jsx)(D,{post:e},e._id)}))]})})}s(133);function U(){Object(N.a)((function(){return{input1:{height:10}}}))();return Object(d.jsx)("div",{className:"main",children:Object(d.jsx)("div",{className:"search",children:Object(d.jsx)(v.a,{id:"outlined-basic",variant:"outlined",size:"small",margin:"none",style:{height:20},fullWidth:!0,label:"Search"})})})}function G(){var e=Object(a.useContext)(h).user,t="https://calfessions.herokuapp.com/images/";return Object(d.jsxs)("div",{className:"topbarContainer",children:[Object(d.jsxs)("div",{className:"topbarLeft",children:[Object(d.jsx)("div",{className:"logoWrapper",children:Object(d.jsx)(o.b,{to:"/",style:{textDecoration:"none"},children:Object(d.jsxs)("div",{className:"topLeftWrapper",children:[Object(d.jsx)("img",{src:t+"logo.png",alt:"",className:"logo"}),Object(d.jsx)("span",{className:"logo",children:"Calfessions"})]})})}),Object(d.jsx)("div",{className:"search",children:Object(d.jsx)(U,{})})]}),Object(d.jsxs)("div",{className:"topbarRight",children:[Object(d.jsx)(o.b,{to:"/profile/".concat(e.username),children:Object(d.jsx)("img",{src:e.profilePicture?t+e.profilePicture:t+"person/noAvatar.png",alt:"",className:"topbarImg"})}),Object(d.jsx)(g,{})]})]})}s(137);function q(e){var t=Object(a.useState)([{name:"classes",isChecked:!1},{name:"roommates",isChecked:!1},{name:"clubs",isChecked:!1},{name:"housing",isChecked:!1},{name:"relationships",isChecked:!1},{name:"food",isChecked:!1},{name:"travel",isChecked:!1},{name:"fun",isChecked:!1},{name:"advice",isChecked:!1},{name:"life",isChecked:!1},{name:"thirst",isChecked:!1},{name:"rant",isChecked:!1},{name:"wholesome",isChecked:!1},{name:"sad",isChecked:!1},{name:"miscellaneous",isChecked:!1}]),s=Object(i.a)(t,2),c=s[0],n=s[1],r=new Map([["classes",L.b],["roommates",R.a],["clubs",L.a],["housing",R.b],["relationships",L.c],["food",_.a],["travel",L.d],["fun",A.a],["advice",E.a],["life",R.c],["thirst",B.a],["rant",A.b],["wholesome",R.d],["sad",F.a],["miscellaneous",R.e]]),o=function(t,s){var a=r.get(t.name);return Object(d.jsxs)("span",{className:"".concat(t.isChecked?"selectedRight":""," tagButtonRight"),children:[Object(d.jsx)(a,{}),Object(d.jsx)("input",{type:"button",className:"buttonInside",value:t.name,onClick:function(){return function(t,s){var a=Object(l.a)(c);a[t].isChecked=s,n(a);var r=[];a.forEach((function(e){e.isChecked&&r.push(e.name)})),e.onTagClick(r)}(s,!t.isChecked)}})]})},u=function(){return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:"tagsWrapper",children:[Object(d.jsx)("b",{className:"filter",children:"Filter by"}),Object(d.jsx)("div",{className:"tagsContainer",children:c.map((function(e,t){return o(e,t)}))})]})})};return Object(d.jsx)("div",{className:"rightbar",children:Object(d.jsx)("div",{className:"rightbarWrapper",children:Object(d.jsx)(u,{})})})}s(138);function J(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),s=t[0],c=t[1];return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(G,{}),Object(d.jsxs)("div",{className:"homeContainer",children:[Object(d.jsx)(W,{tags:s}),Object(d.jsx)(q,{onTagClick:function(e){c(e)}})]})]})}s(139);var M=function(){var e=Object(k.a)(y.a.mark((function e(t,s){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"LOGIN_START"}),e.prev=1,e.next=4,S.a.post("/auth/login",t);case 4:a=e.sent,s({type:"LOGIN_SUCCESS",payload:a.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),s({type:"LOGIN_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,s){return e.apply(this,arguments)}}();function z(){var e=Object(a.useRef)(),t=Object(a.useRef)(),s=Object(a.useContext)(h),c=(s.user,s.isFetching),n=(s.error,s.dispatch);return Object(d.jsx)("div",{className:"login",children:Object(d.jsxs)("div",{className:"loginWrapper",children:[Object(d.jsxs)("div",{className:"loginLeft",children:[Object(d.jsx)("h3",{className:"loginLogo",children:"Calfessions"}),Object(d.jsx)("span",{className:"loginDesc",children:"An anonymous place to share your UC Berkeley secrets."})]}),Object(d.jsx)("div",{className:"loginRight",onSubmit:function(s){s.preventDefault(),M({email:e.current.value,password:t.current.value},n)},children:Object(d.jsxs)("form",{className:"loginBox",children:[Object(d.jsx)("input",{placeholder:"Email",type:"email",required:!0,className:"loginInput",ref:e}),Object(d.jsx)("input",{placeholder:"Password",type:"password",required:!0,minLength:"6",className:"loginInput",ref:t}),Object(d.jsx)("button",{className:"loginButton",children:c?"Loading...":"Log In"}),Object(d.jsx)("span",{className:"loginForgot",children:"Forgot Password?"}),Object(d.jsx)(o.b,{to:"/register",style:{textDecoration:"none"},children:Object(d.jsx)("button",{className:"loginRegisterButton",children:"Create a New Account"})})]})})]})})}s(140),s(141),s(142);function Y(){var e=Object(a.useContext)(h).user,t=Object(a.useState)([]),s=Object(i.a)(t,2),c=(s[0],s[1]);return Object(a.useEffect)((function(){var t=function(){var t=Object(k.a)(y.a.mark((function t(){var s;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.a.get("/users/friends/".concat(e._id));case 3:s=t.sent,c(s.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t()}),[e._id]),Object(d.jsx)("div",{className:"sidebar"})}var V=s(193),H=s(195),K=s(13);function Q(){var e=Object(a.useState)({}),t=Object(i.a)(e,2),s=(t[0],t[1]),n=Object(a.useState)(null),r=Object(i.a)(n,2),o=(r[0],r[1],Object(a.useContext)(h).dispatch,Object(K.h)().username),l=Object(a.useState)("yourPosts"),u=Object(i.a)(l,2),j=u[0],b=u[1],p=c.a.useState(!1),m=Object(i.a)(p,2),O=m[0],f=m[1],x=c.a.useState(!0),g=Object(i.a)(x,2),v=g[0],N=g[1],C=function(e,t){N(!e),f(!t)};Object(a.useEffect)((function(){var e=function(){var e=Object(k.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.a.get("/users?username=".concat(o));case 3:t=e.sent,s(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),window.location.href="/";case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[o]);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(G,{}),Object(d.jsxs)("div",{className:"profile",children:[Object(d.jsx)(Y,{}),Object(d.jsxs)("div",{className:"profileRight",children:[Object(d.jsx)("div",{className:"profileRightTop",children:Object(d.jsx)("h1",{children:"Your Confessions"})}),Object(d.jsx)("div",{className:"toggleWrapper",children:Object(d.jsxs)(H.a,{color:"primary",value:j,exclusive:!0,onChange:function(e,t){b(t)},children:[Object(d.jsx)(V.a,{value:"yourPosts",onClick:function(){return C(v,O)},children:" Your posts"}),Object(d.jsx)(V.a,{value:"likedPosts",onClick:function(){return C(v,O)},children:" Liked posts"})]})}),Object(d.jsxs)("div",{className:"profileRightBottom",children:[v&&Object(d.jsxs)("div",{children:[Object(d.jsx)(W,{username:o})," "]}),O&&Object(d.jsxs)("div",{children:[Object(d.jsx)(W,{username:o,likes:!0})," "]})]})]})]})]})}s(143);function X(){var e=Object(a.useRef)(),t=Object(a.useRef)(),s=Object(a.useRef)(),c=Object(a.useRef)(),n=Object(K.g)(),r=function(){var a=Object(k.a)(y.a.mark((function a(r){var i;return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.preventDefault(),c.current.value===s.current.value){a.next=5;break}s.current.setCustomValidity("Passwords don't match"),a.next=15;break;case 5:return i={username:e.current.value,email:t.current.value,password:s.current.value},a.prev=6,a.next=9,S.a.post("/auth/register",i);case 9:n("/login"),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(6),console.log(a.t0);case 15:case"end":return a.stop()}}),a,null,[[6,12]])})));return function(e){return a.apply(this,arguments)}}();return Object(d.jsx)("div",{className:"login",children:Object(d.jsxs)("div",{className:"loginWrapper",children:[Object(d.jsxs)("div",{className:"loginLeft",children:[Object(d.jsxs)("div",{className:"loginLogoWrapper",children:[Object(d.jsx)("img",{src:"https://calfessions.herokuapp.com/images/logo.png",alt:"",className:"logoImg"}),Object(d.jsx)("h3",{className:"loginLogo",children:"Calfessions"})]}),Object(d.jsx)("span",{className:"loginDesc",children:"An anonymous place to share your UC Berkeley secrets."})]}),Object(d.jsxs)("div",{className:"loginRight",children:[Object(d.jsx)("div",{className:"loginBoxTitle",children:"Join the Calfessions Community"}),Object(d.jsxs)("form",{className:"loginBox",onSubmit:r,children:[Object(d.jsx)("input",{placeholder:"Username",required:!0,ref:e,className:"loginInput"}),Object(d.jsx)("input",{placeholder:"Berkeley email (for verification only)",required:!0,ref:t,type:"email",className:"loginInput"}),Object(d.jsx)("input",{placeholder:"Password",required:!0,ref:s,type:"password",className:"loginInput",minLength:"6"}),Object(d.jsx)("input",{placeholder:"Password Again",required:!0,ref:c,type:"password",className:"loginInput"}),Object(d.jsx)("button",{className:"loginButton",type:"submit",children:"Sign Up"}),Object(d.jsx)("hr",{}),Object(d.jsx)("div",{className:"buttonDescrip",children:"Already have an account?"}),Object(d.jsx)(o.b,{to:"/login",style:{textDecoration:"none"},children:Object(d.jsx)("button",{className:"loginRegisterButton",children:"Log in"})})]})]})]})})}var Z=function(){var e=Object(a.useContext)(h).user;return Object(d.jsx)(o.a,{children:Object(d.jsxs)(K.d,{children:[Object(d.jsx)(K.b,{path:"/",element:e?Object(d.jsx)(J,{}):Object(d.jsx)(X,{})}),Object(d.jsx)(K.b,{path:"/login",element:e?Object(d.jsx)(K.a,{to:"/"}):Object(d.jsx)(z,{})}),Object(d.jsx)(K.b,{path:"/register",element:e?Object(d.jsx)(K.a,{to:"/"}):Object(d.jsx)(X,{})}),Object(d.jsx)(K.b,{path:"/profile/:username",element:e?Object(d.jsx)(Q,{}):Object(d.jsx)(K.a,{to:"/login"})})]})})};r.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(p,{children:Object(d.jsx)(Z,{})})}),document.getElementById("root"))},68:function(e,t,s){},99:function(e,t,s){}},[[144,1,2]]]);
//# sourceMappingURL=main.3ef2deff.chunk.js.map